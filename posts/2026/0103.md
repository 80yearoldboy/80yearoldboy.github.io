---
title: 类欧几里得算法学习笔记1（f函数篇）
tags: [原创]
categories: [OI]
date: 2026-01-03
description: 类欧几里得算法学习笔记1（f函数篇）
articleGPT: 本文是类欧几里得算法的学习笔记。  
---
> Update on 1.11 修复了一些LaTeX的语法错误。  

&nbsp;&nbsp;之前打某场比赛时看到这样一道题：  
已知某一次函数的表达式为 $ \displaystyle y=\frac{ax+b}{c} $，在 $x \in [0,n] $ 且 $x \in \mathbb Z $ 时，求在函数图像下有多少个整点。  
  
&nbsp;&nbsp;当时还不知道这是个什么东西，但后来发现这是类欧几里得的板子。  
&nbsp;&nbsp;我们再来观察一下刚才的问题，发现该问题的答案可以用一下式子表示：
$$
\begin{aligned}
\sum^n_{i=0}{\lfloor\frac{ai+b}{c}\rfloor}\
\end{aligned}
$$  
&nbsp;&nbsp;但是直接算的话肯定会超时，但类欧几里得算法提供了计算该式子的一种更快的方式。  
&nbsp;&nbsp;接下来是推导过程。  
&nbsp;&nbsp;我们令 $\displaystyle f(a,b,c,n) = \sum^n_{i=0}{\lfloor\frac{ai+b}{c}\rfloor}$。  
&nbsp;&nbsp;当 $c \le a$ 或 $c \le b$ 时：
$$
\begin{aligned}
f(a ,b ,c ,n) =   \\
f(a\%c ,b\%c ,c ,n) + \frac{n(n+1)}{2}\cdot \lfloor\frac{a}{c}\rfloor + (n+1) \cdot\lfloor\frac{b}{c}\rfloor
\end{aligned}
$$  
否则令 $\displaystyle m = \frac{an+b}{c}$，则可做如下变形：  
$$
\begin{aligned}
f(a,b,c,n)&=\\
\sum^n_{i=0}\sum^m_{j=1}[\frac{ai+b}{c}\ge j]&=\\
\sum^n_{i=0}\sum^{m-1}_{j=0}[\frac{ai+b}{c}\ge j+1]&=\\
\sum^n_{i=0}\sum^{m-1}_{j=0}[ai\ge cj+c-b]&=\\
\sum^n_{i=0}\sum^{m-1}_{j=0}[ai>cj+c-b-1]&=\\
\sum^n_{i=0}\sum^{m-1}_{j=0}[i>\frac{cj+c-b-1}{a}]&=\\
\sum^{m-1}_{j=0}\sum^n_{i=0}[i>\frac{cj+c-b-1}{a}]&=\\
\sum^{m-1}_{j=0}(n-\frac{cj+c-b-1}{a})&=\\
\sum^{m-1}_{j=0}n-\sum^{m-1}_{j=0}\frac{cj+c-b-1}{a}&=\\
\sum^{m}_{j=1}n-\sum^{m-1}_{j=0}\frac{cj+c-b-1}{a}&=\\
mn-f(c,c-b-1,a,m-1)
\end{aligned}
$$  
&nbsp;&nbsp;特别的，当 $a=0$ 时，$f(a,b,c,n)=(n+1)\cdot\lfloor\frac{b}{c}\rfloor$。  
&nbsp;&nbsp;这也是整个递归的结束条件。
&nbsp;&nbsp;这种算法可达到 $O(log\space n)$ 的时间复杂度。  
&nbsp;&nbsp;下面给出代码。
```cpp
#include<bits/stdc++.h>
using namespace std;
int a,b,c,n;
int f(int a,int b,int c,int n){
	if(a==0){
		return (n+1)*(b/c);
	}
	if(a>=c||b>=c){
		return f(a%c,b%c,c,n)+n*(n+1)/2*(a/c)+(n+1)*(b/c);
	}
	else{
		int m=(a*n+b)/c;
		if(m==0)return 0;
		return m*n-f(c,c-b-1,a,m-1);
	}
}
int main(){
	cin>>a>>b>>c>>n;
	cout<<f(a,b,c,n);
	return 0;
} 
```
&nbsp;&nbsp;至此，我们已经实现了类欧几里得的 $f$ 函数的推导，板子题已经有 40 分了。  
&nbsp;&nbsp;同时，类欧几里得还有 $\displaystyle g(a,b,c,n) = \sum^n_{i=0}{i\lfloor\frac{ai+b}{c}\rfloor}$ 和 $\displaystyle h(a,b,c,n) = \sum^n_{i=0}{\lfloor\frac{ai+b}{c}\rfloor}^2$。  
&nbsp;&nbsp;由于笔者码力，人品和实力的多重因素，再此不讲。等之后另开文章介绍。
